import numpy as np
import matplotlib.pyplot as plt
import plotly.express as px
import plotly.graph_objects as go


# logfbank + SAEP
# no noise
# 20221229_195421_sid
train_score_list_1 = [0.12897625898148138, 0.6429845852153087, 0.8695770980341729, 0.9273785221738222, 0.9490620931316606, 0.9607156060630415, 0.9688811020204781, 0.974169385819684, 0.9760178740777651, 0.979746998215807, 0.981515117420147, 0.9827849484834359, 0.984054779547683, 0.9861443749698616, 0.9867551797865335, 0.987671387009146, 0.9871409512481314, 0.9892305466712681, 0.9892144728593703, 0.9900663848391815, 0.9910147396846318, 0.9907575587095945, 0.9909825920637102, 0.9920916850176008, 0.9920434635847813, 0.992075611206661, 0.9917059135550448, 0.9924774564801568, 0.9928953755645926, 0.9932168517833894, 0.9938598042209827, 0.9931686303505698, 0.9933775898927877, 0.9941330590069599, 0.9944706090366965, 0.9930400398630511, 0.9943580923601176, 0.9936508446787649, 0.9941812804397795, 0.9943580923601176, 0.994808159066433, 0.9943902399819974, 0.9951939305289891, 0.9948724543101924, 0.9951778567180493, 0.9944706090366965, 0.9955154067477858, 0.994615273335155, 0.9951457090961696, 0.9957082924790639, 0.9954189638821468, 0.9959976210759809, 0.9954832591259062, 0.9955636281806053, 0.9960779901306801, 0.996672721135454, 0.9952100043399289, 0.9967530901901532, 0.9951296352852298, 0.9956922186681241, 0.9962708758619581, 0.9960136948869207, 0.9954189638821468, 0.9956922186681241, 0.9961422853744394, 0.9962065806181988, 0.9961744329963191, 0.9961422853753975, 0.9960136948869207, 0.9965602044588752, 0.9969781235433108, 0.9959172520212817, 0.9964476877822963, 0.9964637615932361, 0.9967530901901532, 0.9966887949463938, 0.9969299021104914, 0.9962226544291386, 0.9968173854339125, 0.9966405735135744, 0.9967048687573337, 0.9970906402198897, 0.9965119830260556, 0.996865606866732, 0.9968013116229727, 0.9963512449166573, 0.9971227878417694, 0.9965923520807548, 0.9967370163792133, 0.9989552022889107, 0.9998231880796619, 0.9999839261890602, 0.9999678523781204, 0.9999839261890602, 1.0, 0.9999678523781204, 0.9999839261890602, 0.9999678523781204, 1.0, 1.0, 0.006349155321235112, 0.007313583977625255, 0.015237972770964267, 0.05675662642855995, 0.14075836240062048, 0.3487052545290357, 0.5851027920214393, 0.7374664459215793, 0.8353077331114013, 0.8879494639384051, 0.9188754761876071, 0.9370388825486634, 0.9519875267227107, 0.9599601369488692, 0.9644608040120232, 0.9728513333226174, 0.9745069358494205, 0.9762911288637423, 0.9790076029125745, 0.9820616269911433, 0.9827045794287368, 0.984247665278961, 0.9840065581148635, 0.9863533345120795, 0.9874945750888078, 0.9872534679247102, 0.9879928632279427, 0.9901789015157604, 0.9889572918843329, 0.9900503110282417, 0.9901949753267002, 0.9915451754456464, 0.9907254110877148, 0.9920916850176008, 0.9926381945895553, 0.9913201420924888, 0.9923488659926382, 0.9917541349878642, 0.9918345040425635, 0.9931364827286902, 0.9934097375146673, 0.9941009113850803, 0.9933775898927877, 0.994133059007918, 0.9937151399225242, 0.994808159066433, 0.993634770867825, 0.9946956423898542, 0.9941491328178998, 0.9944384614148168, 0.9942134280616591, 0.9951457090961696, 0.9951939305289891, 0.9938919518438205, 0.9950010447977111, 0.99511356147429, 0.9951617829071094, 0.9946956423898542, 0.9953385948274477, 0.9950331924195908, 0.9952421519618087, 0.9955475543696655, 0.9960940639416199, 0.9956439972353045, 0.9954832591259062, 0.9952582257727485, 0.9959976210759809, 0.9965119830260556, 0.9954189638821468, 0.996576278269815, 0.9948724543101924, 0.9964476877822963, 0.9956922186681241, 0.9964637615932361, 0.996286949672898, 0.9958690305884622, 0.9965602044588752, 0.9959654734541012, 0.9965441306479353, 0.9964476877822963, 0.9968013116229727, 0.9968173854339125, 0.9964637615932361, 0.9963512449166573, 0.9960940639416199, 0.9977818140903026, 0.996286949672898, 0.9960779901306801, 0.9968013116229727, 0.9971710092745889, 0.999212383263948, 0.9998874833234211, 0.999903557134361, 0.9998874833234211, 0.9999678523781204, 0.999903557134361, 0.9999517785671805, 0.9999678523781204, 0.9998714095124813, 0.9999517785671805, 0.006943886326009034, 0.12969958047353447, 0.49642357706684465, 0.7867808978830791, 0.8863420828453796, 0.9283268770192725, 0.9501551122765275, 0.9603137607895456, 0.9683506662594634, 0.9730763666757751, 0.9769823027341552, 0.9799238101361452, 0.9802613601658817, 0.9831064247022326, 0.9855174963432081, 0.9843119605227203, 0.9870284345715525, 0.986112227347982, 0.9889572918843329, 0.989134103804671, 0.9900342372173019, 0.9887965537749345, 0.99119155160497, 0.9901628277048206, 0.9914005111471879, 0.9921720540723, 0.9910629611174513, 0.9927667850770739, 0.9923327921816983, 0.9916576921222252, 0.9928310803208332, 0.9930239660521113, 0.9940205423303811, 0.9922845707488789, 0.9944706090366965, 0.9904521563017376, 0.9944706090366965, 0.994229501872599, 0.9947438638226738, 0.9433719640589587, 0.9962548020510182, 0.9948242328773729, 0.9948885281211323, 0.9940205423303811, 0.9951939305289891, 0.9952100043399289, 0.9947438638226738, 0.9942455756835388, 0.9962548020510182, 0.994422387603877, 0.9955636281806053, 0.9949688971758314, 0.9956279234243647, 0.9952742995836883, 0.9947599376336136, 0.9962548020510182, 0.995885104399402, 0.9957243662900037, 0.9956761448571841, 0.9955475543696655, 0.9956118496134249, 0.9954189638821468, 0.9962226544291386, 0.9961422853744394, 0.9961101377525597, 0.9960136948869207, 0.9962226544291386, 0.9951457090961696, 0.9964476877822963, 0.9972513783292881, 0.9959493996431614, 0.9974281902496263, 0.9955154067477858, 0.9972513783292881, 0.9963833925385369, 0.9963673187275971, 0.9962065806181988, 0.9966405735135744, 0.9966405735135744, 0.9963351711057175, 0.9962708758619581, 0.996865606866732, 0.9960619163197403, 0.9969299021104914, 0.9963351711057175, 0.9966405735135744, 0.997749666468423, 0.9964959092151158, 0.9965923520807548, 0.9966566473254722, 0.9997267452140228, 0.9999517785671805, 0.9999517785671805, 0.9999678523781204, 0.9999357047562406, 0.9999839261890602, 0.9999839261890602, 0.9999839261890602, 0.9999678523781204, 0.9999839261890602]
val_loss_list_1 = [1.982866974445302, 0.3378605027008418, 0.1489774727695716, 0.09290145894384204, 0.09896085449721183, 0.04867571680259583, 0.07978280721837552, 0.05921591097774311, 0.052946862198250136, 0.034598154880394125, 0.06808617702064147, 0.03432512328636322, 0.05502451589120749, 0.06671644265037936, 0.04457175375258993, 0.04211569001671109, 0.027767105191388232, 0.023117523567564777, 0.054451199910204424, 0.0381201422497582, 0.023207004266403923, 0.03684622799608832, 0.06119206303676676, 0.02107084586201986, 0.01570470356768742, 0.028139205468822637, 0.04148597979876782, 0.03090225685964377, 0.02189440555757669, 0.02133228047193084, 0.06658799972360037, 0.03794173362391521, 0.030639373298503303, 0.04451433961894627, 0.0646836407127486, 0.024415172740520064, 0.01742722863300147, 0.028682626142480183, 0.0211956368293254, 0.053140396913547806, 0.01725917061871182, 0.04559537765527904, 0.05228892185834723, 0.04481168277964226, 0.018508541125885788, 0.03109178264035248, 0.07181185258495805, 0.013244883415741357, 0.015998561682642194, 0.03043060325771179, 0.02697650316543832, 0.021163077372586752, 0.04323092683336348, 0.021103276572250584, 0.027362999151767455, 0.02457228130182148, 0.015538132988369372, 0.007965272143507953, 0.015273216117198046, 0.024152333726521678, 0.019429736637240413, 0.015118884755163781, 0.04903112196392036, 0.031532137372507436, 0.03274544580030381, 0.07680523430141425, 0.02825900966254351, 0.020841273195397067, 0.0350626602271219, 0.015347798729882286, 0.013288949182270922, 0.01884693944251768, 0.018429227570959703, 0.05334929858819284, 0.015387803507305283, 0.015447879575004469, 0.02811385025930419, 0.02446626219081042, 0.02117137682772917, 0.013568534228022684, 0.015454111386767935, 0.05116492685093774, 0.022289676391168703, 0.027909258861291718, 0.025359283193224794, 0.02217344310134526, 0.013739766792306237, 0.0123422281094112, 0.05499573009988823, 0.013776770422837032, 0.006044311606933944, 0.005590978724165304, 0.004653081541524849, 0.009409492583556705, 0.004502960387389192, 0.004828321113390705, 0.006742774005604126, 0.004980460054087853, 0.004561198333225972, 0.004648798902803234, 5.507501997316572, 5.505275702675906, 4.805388891620477, 3.771100449632714, 2.8408308986497426, 1.4537298458374455, 0.7870924367003496, 0.48181446752423746, 0.260975339833921, 0.2605686064144365, 0.15625930616106556, 0.1118501549632516, 0.10084409887091561, 0.12055922626532978, 0.06824933706694701, 0.0749834991778241, 0.06501533606362485, 0.06276142053882158, 0.08446660160559259, 0.06683817881690031, 0.041682426655340395, 0.04187601164192712, 0.05370849640319928, 0.036094590427320064, 0.03570319736433009, 0.05132713132285399, 0.04403272677720056, 0.06513489001283021, 0.035278879927372754, 0.03605615536196232, 0.06027188904764947, 0.03547361958093004, 0.019983081331746432, 0.030701701440514248, 0.043403684973503366, 0.02194336698409853, 0.03487252218650352, 0.032073855510959655, 0.025513361483183127, 0.053047951005719976, 0.0238929255713553, 0.033044003509684935, 0.02595175560650646, 0.026654250770216856, 0.020813328777961163, 0.05791554078564297, 0.024345360650462982, 0.050752865441632086, 0.059201933003965125, 0.03563092770666141, 0.024024760423349365, 0.032655873994600626, 0.043512326237362335, 0.04298267370021096, 0.03261186498426234, 0.04262409277708063, 0.025127814810423244, 0.026521795246031633, 0.01870480888737148, 0.017170908969823154, 0.034879788327018504, 0.05059079616694423, 0.040801673629812074, 0.021760773518735534, 0.039916669284906774, 0.026228439746572796, 0.03816097684592047, 0.03898305749051483, 0.024935081906656525, 0.017800256322412458, 0.01592793367195459, 0.01220750318104753, 0.01994093037607815, 0.016363162170584433, 0.023396618628510626, 0.03468311885218043, 0.012522699774804209, 0.027422465039909718, 0.014105784477872816, 0.032500047006296766, 0.01859053321179611, 0.019046900018409012, 0.028445100922698252, 0.023736816113838446, 0.013932383630991314, 0.03779949058000352, 0.022766823269902838, 0.022635599124056285, 0.028642972449490732, 0.05328733563515075, 0.008844468307236081, 0.008028189803397591, 0.007656635421029159, 0.008173789043641784, 0.0073361683972729096, 0.008992270379176605, 0.007938720691168924, 0.008257125311229692, 0.00684524098327419, 0.007894655918847129, 5.054781220221526, 2.3393988942579553, 0.6342720239387692, 0.250899515078922, 0.1967505504271455, 0.08190024117491904, 0.09315503799678465, 0.06147422187353203, 0.05368279929409789, 0.05009933351199387, 0.04965048075074732, 0.04353601526744166, 0.03675552930692145, 0.07706778334454639, 0.039725450450319576, 0.025969218183721225, 0.03272756443507006, 0.046660432362238186, 0.03185998581462827, 0.022500197664571283, 0.035760900339807736, 0.053003947390297554, 0.02651475010105285, 0.021182840369507853, 0.028138176213752926, 0.010630507642454433, 0.03254451537014571, 0.026024638179416526, 0.03788228709684161, 0.02206147803291981, 0.017510037174968966, 0.026223523316571188, 0.032943937116675565, 0.02530813870750818, 0.019954697592685113, 0.025162660767192726, 0.05281640236102405, 0.03763742213645, 0.032502328721521166, 0.037983318989212055, 0.020713418636780168, 0.02286136250669502, 0.01878605701364822, 0.03568951899677037, 0.017253249935347516, 0.044075831188791374, 0.02494663136021634, 0.02451452624596631, 0.010188440213180735, 0.016713515195819956, 0.04467000241820885, 0.012679743378922055, 0.020835149606025324, 0.025057730326361983, 0.022568873068950532, 0.04286787922672916, 0.01003087785994533, 0.013720328890103611, 0.040759286410553916, 0.11468915448190604, 0.016907029415948776, 0.02951642557757041, 0.033514158835867815, 0.018050035977270475, 0.014811664287410745, 0.028293473336003263, 0.03764301129718146, 0.030881124381475895, 0.020939088631034386, 0.021875765092652003, 0.012780330256417827, 0.009099461347411535, 0.021325765301777117, 0.014883769361345014, 0.035951669115616564, 0.02808480145963224, 0.009579457477677937, 0.0176138365587442, 0.0581575624328561, 0.05634302157376151, 0.04112110743705758, 0.03425671635382829, 0.027704344960612262, 0.01336936042323696, 0.027830600615065416, 0.017743491716700515, 0.010602554940140865, 0.01884570566031046, 0.012935465739657844, 0.010220491113166601, 0.006619274147297446, 0.006294814149493623, 0.007104589838004229, 0.007594952027357543, 0.007184525288293299, 0.007442822323768062, 0.0061071044521727414, 0.006589657409704297, 0.0064935683313576565, 0.0065631085799700475]
train_loss_list_1 = [4.063942141517032, 1.320877296194194, 0.4613137386307282, 0.2532913774233255, 0.17354472630034343, 0.13308416030568215, 0.10627734410120644, 0.08631206986845721, 0.07822144766498618, 0.06427356924048444, 0.05893023171719047, 0.056210953679459476, 0.05142349346588914, 0.04395999230737228, 0.04328208314675983, 0.039411931505242845, 0.04197268859722172, 0.03394928996023225, 0.03420986374462899, 0.03455759412105753, 0.02853258857203966, 0.03089276802730151, 0.029568358024856755, 0.027501111751566165, 0.02534097201731295, 0.026241173977195262, 0.027107393855686092, 0.0257106344540241, 0.025329214902735233, 0.022613352661170788, 0.020135323391036877, 0.024722164159633825, 0.022633074514310094, 0.019727692000546145, 0.01781565330658898, 0.02290527999380583, 0.01904921048047575, 0.022433926912986325, 0.02032869997368778, 0.018281139596221168, 0.017247450588962356, 0.019473875283926755, 0.0165644556432514, 0.01830463531753995, 0.017275553886398367, 0.019258405398493977, 0.0148953046954128, 0.01721553466783882, 0.01749422542663669, 0.015560291607286135, 0.016796270384324387, 0.013091154090814162, 0.01694976325260433, 0.016592241618672357, 0.01446628156522459, 0.012434976048970526, 0.016350494510528564, 0.012360650391039507, 0.017596661276109676, 0.014474895455904578, 0.013717090097407184, 0.013883744663749507, 0.0161238736229225, 0.014000018745154226, 0.013951625322921754, 0.0139486240260186, 0.013863016164076555, 0.013786554784056729, 0.013421453724236983, 0.012746545725203045, 0.010429062494089777, 0.013354990377672953, 0.013384929219419762, 0.01331305741226744, 0.011201781465763333, 0.011833889423539867, 0.011303715754280918, 0.014065080587401045, 0.012716637521610952, 0.012715260019027223, 0.012385218750083402, 0.010356067595112033, 0.013303638382609367, 0.01216002844546845, 0.011521477497035982, 0.012952099783943544, 0.010801978050749632, 0.011922302684175407, 0.012772769266098532, 0.003953425558375478, 0.0006138596608850583, 0.00019455750048304337, 0.0001325441635787936, 0.00016753920379633527, 0.00011829992498931904, 9.40030321789496e-05, 0.00013152846193195282, 0.00014279030639705677, 3.971209639488176e-05, 8.777148148767823e-05, 5.516051575288804, 5.508016885605963, 5.161566918540058, 4.250171303218312, 3.4379705046046913, 2.3803862126794506, 1.455964952881181, 0.9035112529572942, 0.5682999806849963, 0.3833328867104054, 0.272531012868091, 0.20929361255886023, 0.16132896183730588, 0.13186462306558885, 0.116952911207961, 0.08958690980562761, 0.0835325522762502, 0.07603311024225633, 0.06832519886177538, 0.057392018029135274, 0.0561562484828265, 0.04938388761607831, 0.05187874523185503, 0.04122477123841988, 0.041483507508534245, 0.04089507921486053, 0.04061715200974627, 0.032265831954126335, 0.03502632149412603, 0.0331855377771672, 0.031999423064119445, 0.02868912929592731, 0.03222814367910961, 0.027206222600864693, 0.02470433500767184, 0.030232507393097307, 0.026476786427121327, 0.0277800778273134, 0.027311698895322666, 0.021651560663111347, 0.021842112896950917, 0.019425707451039383, 0.021952450576373208, 0.021120813641825525, 0.02256289610366083, 0.018740374512049476, 0.02132704947892943, 0.018066769509145594, 0.020237899051285015, 0.01852620391376397, 0.019574007222111327, 0.016760147563469573, 0.016014419210312505, 0.020409884449378638, 0.016770585962976942, 0.016904459169405008, 0.0167538689159019, 0.018344517581608582, 0.017387804326695896, 0.016842017323228313, 0.016019005234172747, 0.016086433497765517, 0.013698747106519145, 0.015890904486065702, 0.015300510127172992, 0.01629031524965949, 0.01361851708796794, 0.011828706476293317, 0.01713598192326867, 0.012607703756227103, 0.018866520154636236, 0.013830440181469745, 0.01488769171740699, 0.011940449919779123, 0.012708651802731034, 0.014934394368246635, 0.013548905950209812, 0.013802339635453074, 0.01194404699310382, 0.013996759660032863, 0.011325534482541748, 0.011902631554431092, 0.01235404255478238, 0.012134856755202808, 0.014937444510718104, 0.007835500002842674, 0.012567065320952042, 0.014150166115535708, 0.011303387860871462, 0.010574571652185321, 0.0027412009468610107, 0.0006282956112605665, 0.0004434456928507202, 0.0004714469313623019, 0.0003212453832113608, 0.00032744314917010505, 0.0002524423643940411, 0.00015349201752066978, 0.0003481576498442121, 0.00020663175957233982, 5.438038811786283, 3.851855504710725, 1.8357418742964802, 0.734580427350255, 0.3880237760802963, 0.2426398062275148, 0.16645869312433462, 0.13154074236037555, 0.10485041183280155, 0.09137150811565677, 0.07704209073203595, 0.06724171099260223, 0.06495384935695171, 0.054444739020690344, 0.04821118259159024, 0.0511245057424379, 0.043072653508499495, 0.045816366291280664, 0.03683101805442798, 0.035540332327882514, 0.033848329353217556, 0.03974769954549496, 0.029552034684372678, 0.03181653246392456, 0.029677769570502267, 0.02647436448234771, 0.030280681485207878, 0.02506789641462061, 0.02665680894237988, 0.029538508436085693, 0.024220023422824942, 0.023301945878307754, 0.022522302667305205, 0.026693281180848825, 0.020282925037358287, 0.0347864599328834, 0.020342585101519466, 0.018647184829138536, 0.01896326795116523, 0.2913273556354187, 0.01455674039218816, 0.020015666086839724, 0.020520324412721735, 0.019909079260637015, 0.018275790239786194, 0.018514538830980184, 0.018258265324267147, 0.022061298063823967, 0.013924943865035717, 0.020605237881712406, 0.015355148224011128, 0.01833005085127559, 0.016803686680109294, 0.017653165436025447, 0.018137051535432692, 0.013895825506707956, 0.015143126785174734, 0.015155614606817669, 0.015996864474400865, 0.015471769844654502, 0.015897370098292063, 0.01728755405769227, 0.013830941077417974, 0.013880459094446884, 0.014202708998893542, 0.013724530935886001, 0.01528196254080535, 0.01719942161189791, 0.013541262202082502, 0.010550296913252929, 0.015936326500981333, 0.009997629835924006, 0.01719783303696831, 0.011435451052269773, 0.013523104276701985, 0.014115805753445673, 0.014991129549934491, 0.013344313817465264, 0.012238273236969603, 0.01299923723142509, 0.013665118003639315, 0.01054727065511733, 0.014231093947283576, 0.011724736834550711, 0.013547272036160162, 0.013491916240359149, 0.00874998165919163, 0.01440735573904981, 0.012128821754327865, 0.012427338616029359, 0.0009162619227161222, 0.0002600887835943527, 0.0003590355254265331, 0.00023626284830098425, 0.0002828382838717004, 0.0001734733948782692, 0.00014747130726794198, 0.00010152549535458267, 0.0001267293921909964, 8.581787824892153e-05]
val_score_list_1 = [0.5388740951970303, 0.9195139331836941, 0.9601320181569669, 0.974346472639988, 0.9709710085136706, 0.9861605970820988, 0.9768218129992874, 0.9816224730900499, 0.9846978959606946, 0.989048494167948, 0.9813599369913363, 0.9898736076210479, 0.9832351948392904, 0.9819975246596407, 0.987173236319994, 0.9886359374413982, 0.9920489067425585, 0.9933240820612834, 0.9866106589656077, 0.9897610921501706, 0.9934741026891197, 0.989461050894498, 0.9828601432696996, 0.9944117316309806, 0.9954618760079511, 0.9928365150208154, 0.9888984735401117, 0.9918238757829202, 0.9938866594156697, 0.9941491955143832, 0.9835727412519222, 0.9893485354415046, 0.9922739376664291, 0.9895360612084162, 0.9846603908037355, 0.9936616284739151, 0.9956494017927465, 0.9921614222134357, 0.9949743089674831, 0.987623298203503, 0.9960994636762555, 0.98856092712748, 0.9879608446161348, 0.9879233394591757, 0.9951993399092375, 0.99264898923602, 0.982147545287477, 0.9965120204028054, 0.9955743914788283, 0.9929865356486517, 0.9930615459625699, 0.9947867831826877, 0.9905487004463114, 0.9949743089674831, 0.9932115665904062, 0.9943367212991786, 0.9956494017927465, 0.9976746802685369, 0.9955368863218692, 0.9938116491017515, 0.9951243295953194, 0.9964745152458463, 0.9884109064996437, 0.9918238757829202, 0.991748865469002, 0.9848479165885309, 0.9932490717473652, 0.9948242883396468, 0.9912612984285339, 0.9963995049319282, 0.9969620822863143, 0.9954618760079511, 0.9951618347522785, 0.9878108239882983, 0.9962494843040918, 0.9957994224205828, 0.9932865769043243, 0.9941116903574242, 0.9946367625548513, 0.9962869894610509, 0.995874432734501, 0.9890859993249072, 0.9954618760079511, 0.9936991336308743, 0.9938491542587106, 0.9945992573978922, 0.9966245358736826, 0.9970370926002325, 0.9884109064996437, 0.9966245358736826, 0.9983872782507595, 0.9984997937216368, 0.9986873195064321, 0.9980497318381277, 0.9988373401342685, 0.9988748452912275, 0.9983122679368414, 0.9989123504481866, 0.9989498556051457, 0.9987623298203503, 0.008026103589243522, 0.008026103589243522, 0.027753816149720587, 0.11124029554231345, 0.26313618123386034, 0.6255860180953695, 0.7857705434676082, 0.8696695795850743, 0.9291527585042944, 0.927164985189934, 0.957469152026285, 0.9692082661365938, 0.9714585755541387, 0.9667704309342534, 0.9812099163635, 0.9779469677080599, 0.9832726999962494, 0.9829351535836177, 0.9764467614296966, 0.9819600195026816, 0.9886359374413982, 0.989048494167948, 0.9859355661403443, 0.9902861643475978, 0.9914863293702885, 0.9866481641225668, 0.9892360199527435, 0.9860480816112216, 0.991298803585493, 0.9904361849754342, 0.9836102464267651, 0.9912612984285339, 0.9945992573978922, 0.9920489067246746, 0.9918238757829202, 0.9943742264561377, 0.9915613396842066, 0.9923489479803473, 0.993624123316956, 0.9868356899073623, 0.9944117316130968, 0.9917113603120429, 0.9935116078460788, 0.9935116078460788, 0.9950868244383603, 0.986685669279526, 0.9942617109852605, 0.9878108239882983, 0.9873232569657142, 0.990923752033786, 0.9948992986535649, 0.9925739789399857, 0.9899861230919251, 0.9897235869932116, 0.9917863706259611, 0.9896485766792934, 0.9930990511195289, 0.9938866594156697, 0.9956494017927465, 0.9961369688332146, 0.9922739376664291, 0.9877358136743802, 0.9906987210741477, 0.9948617934966058, 0.991336308742452, 0.9936991336308743, 0.9916738551550838, 0.9907737313880659, 0.9938491542587106, 0.9959494430484191, 0.9966995462054846, 0.9968870719723962, 0.9950493192814012, 0.9959494430484191, 0.9941867006713423, 0.9913738138994111, 0.9975621647976597, 0.9930240408056108, 0.9969245771293553, 0.9925364737651428, 0.9951618347522785, 0.9951243295953194, 0.9920864118816337, 0.9939991748865469, 0.9967745565015189, 0.9918613809398792, 0.9947867831826877, 0.995424370850992, 0.9932865769043243, 0.9890859993249072, 0.9980122266811686, 0.9981247421520459, 0.9986498143494731, 0.9982747627798823, 0.9983872782507595, 0.998199752465964, 0.9983122679368414, 0.9983872782507595, 0.9985748040355549, 0.9986498143494731, 0.01901511457825451, 0.4227581292494773, 0.8469789596114169, 0.9348535423799587, 0.9461050894676832, 0.9779469677080599, 0.9733338334020928, 0.9830101638975359, 0.9854104939429171, 0.9854479990998762, 0.9856355248846717, 0.987660803360462, 0.9892360199527435, 0.9803848029104002, 0.989461050894498, 0.9927239995499381, 0.991298803585493, 0.987623298203503, 0.9911862881146157, 0.9939241645726288, 0.9905111952893523, 0.9845103701758992, 0.9928740201777745, 0.9939991748865469, 0.9931740614334471, 0.9969995874432734, 0.9923114428233882, 0.9931740614334471, 0.9917863706259611, 0.9938866594156697, 0.9954993811649102, 0.9926114840790609, 0.9922739376664291, 0.993136556276488, 0.9945992573978922, 0.9933615872182425, 0.9862356073960169, 0.9897610921501706, 0.9928740201777745, 0.9896110715223343, 0.9946367625548513, 0.9941116903574242, 0.9953493605370739, 0.9924239582942654, 0.9952743502231557, 0.9905487004463114, 0.993624123316956, 0.9939616697295878, 0.9971871132280689, 0.9948992986535649, 0.9893485354236208, 0.9970370926002325, 0.9951618347522785, 0.9937741439447924, 0.9939991749044308, 0.9909237520159022, 0.9971871132280689, 0.9965495255597645, 0.9910362674867794, 0.975734163447474, 0.995424370850992, 0.9934741026891197, 0.9919363912537974, 0.9950118141244421, 0.9965870307167235, 0.9929490304916926, 0.9902486591906388, 0.9921989273525109, 0.9944117316130968, 0.9942992161422196, 0.9970370926002325, 0.9975621647976597, 0.9948617934966058, 0.99591193789146, 0.9926864943929791, 0.9935116078460788, 0.9977871957394142, 0.9959869482053783, 0.9878858343022165, 0.9863106177099351, 0.9909237520159022, 0.9930240408056108, 0.9937366387878334, 0.9975246596407006, 0.9934741026891197, 0.9957619172636237, 0.9977871957394142, 0.9953868656940329, 0.9968495668154371, 0.9976371751115778, 0.9984997937216368, 0.9986498143494731, 0.998612309192514, 0.9985748040355549, 0.9986498143494731, 0.9984247834077186, 0.9989123504481866, 0.9988373401342685, 0.9986873195064321, 0.9988373401342685]
tb1 = max(train_score_list_1)
vb1 = max(val_score_list_1)
tba1 = (max(train_score_list_1[0:100])+max(train_score_list_1[100:200])+max(train_score_list_1[200:300]))/3.0
vba1 = (max(val_score_list_1[0:100])+max(val_score_list_1[100:200])+max(val_score_list_1[200:300]))/3.0
print(str(tb1)+" "+str(vb1) + " "+str(tba1) +" "+ str(vba1))

train_score_list_1=train_score_list_1[0:100]
val_loss_list_1 = val_loss_list_1[0:100]
train_loss_list_1=train_loss_list_1[0:100]
val_score_list_1 =val_score_list_1[0:100]

'''print(val_loss_list_1[99])
print(val_loss_list_1[100])
print(val_score_list_1[99])
print(val_score_list_1[100])

print(len(train_score_list_1))
print(1)'''
fig1 = go.Figure()
fig1.add_trace(go.Scatter(y=train_score_list_1, \
                mode='lines', name="train score"))
fig1.add_trace(go.Scatter(y=train_loss_list_1, \
                mode='lines', name="train loss"))
fig1.add_trace(go.Scatter(y=val_score_list_1, \
                mode='lines', name="validation score"))
fig1.add_trace(go.Scatter(y=val_loss_list_1, \
                mode='lines', name="validation loss"))
fig1.update_layout(title='training process of logfbank+SAEP(no noise)', xaxis_title='epoch n', yaxis_title='score or loss')
fig1.write_image("output/logfbank_SAEP_no_noise.png")
# fig1.show()


# logfbank + SAEP
# add noise (训练集和验证集全部样本加了噪声)
# 20221230_184247_sid
val_score_list_2 = [0.0044256085211716615, 0.004538123992048906, 0.0044256085211716615, 0.004463113678130743, 0.004538123992048906, 0.004500618835089825, 0.004538123992048906, 0.004538123992048906, 0.004538123992048906, 0.004538123992048906, 0.004500618835089825, 0.006450886996962083, 0.013576866819187638, 0.026291115028316395, 0.07238495293102802, 0.1555713910662716, 0.2320069009522337, 0.300228781459127, 0.34921051645495327, 0.4550500693878936, 0.5078198252304396, 0.55151333308777, 0.5659903236739755, 0.5959194389295583, 0.6472264936607598, 0.6959831976963887, 0.7129355286351874, 0.7483403968224445, 0.7809698833768457, 0.7969845853849608, 0.7959719461604785, 0.8109740089306983, 0.8156246484070374, 0.847504031808844, 0.8671192289118568, 0.8703821775672969, 0.8866969208444975, 0.8881971271228608, 0.8976484266586656, 0.8790458688248448, 0.8835089825029756, 0.8961857255372614, 0.9081498706116794, 0.8808086111885087, 0.8877095600645089, 0.9079248396833378, 0.9022615609646326, 0.9099876233026745, 0.9068371901136406, 0.9165135206090838, 0.9331658102989161, 0.9274275212841766, 0.9207891085024191, 0.9252522221805498, 0.9343284701646476, 0.9239020365479067, 0.9398417282376327, 0.9110377676930578, 0.9292652739751716, 0.9325657278054547, 0.8798334771031017, 0.9371038517796197, 0.9275400367550538, 0.9268274387728312, 0.9452799759966996, 0.9412294190451187, 0.9315155834106004, 0.937778944622767, 0.9234144694895549, 0.9424670892426522, 0.9500056257914277, 0.9389416044884986, 0.9436672542653429, 0.9399167385515509, 0.9499681206165848, 0.9527435022315568, 0.9492180174774032, 0.9292652739930555, 0.9444923677005588, 0.9524434609758842, 0.9398417282376327, 0.9241645726466203, 0.9349660578329521, 0.9339159134380978, 0.9480178524725964, 0.9543937291377564, 0.9208266136593781, 0.9467426771181038, 0.9539061620972884, 0.942842140812243, 0.9711960394554251, 0.9738964107743628, 0.9744589881108653, 0.9740839365412745, 0.9746090087387016, 0.9721336683794022, 0.9738214004425608, 0.9738214004425608, 0.9746465138956607, 0.9746840190526197, 0.004238082736376251, 0.00420057757941717, 0.004538123992048906, 0.004538123992048906, 0.004538123992048906, 0.004463113678130743, 0.004500618835089825, 0.004538123992048906, 0.004538123992048906, 0.004538123992048906, 0.004538123992048906, 0.004500618835089825, 0.004500618835089825, 0.0044256085211716615, 0.005138206503394217, 0.04721899261148408, 0.0885496755803923, 0.11937891460969953, 0.1915763417469902, 0.28200127517980755, 0.3689007238584712, 0.44064808911895936, 0.47860330797272765, 0.537373888914196, 0.6207478528364705, 0.6374001425240674, 0.7093350335760574, 0.7394516746231421, 0.7389641075714966, 0.7670179649880673, 0.805798297270345, 0.8203127930135097, 0.8171248546675168, 0.8104489367288003, 0.8551550838419096, 0.8586055582821452, 0.8631811874177403, 0.8508419907782023, 0.857142857160741, 0.8756704046806436, 0.8860968383331522, 0.8761204665708591, 0.9021490455116392, 0.9046618910100139, 0.8995236845066197, 0.9051119528935229, 0.9068746952705997, 0.9122004275587894, 0.9137381389941117, 0.9198889847354011, 0.9197764692645238, 0.9132880771106027, 0.9218017477581981, 0.9247646551400818, 0.9269774594006676, 0.9240520571578592, 0.9282901398942355, 0.9196264486433939, 0.9333158309267524, 0.9323406968458163, 0.9326032329624138, 0.932640738101489, 0.9360537074026493, 0.9386040580758668, 0.9383040168023103, 0.9324157071597344, 0.9213141806998463, 0.9376664291340059, 0.9366162847391516, 0.9401417694933053, 0.9448674192880335, 0.9373663878962171, 0.9150883246446386, 0.9337658928102615, 0.934591006281245, 0.9505306979888548, 0.9414919551617161, 0.9429921614221956, 0.9488054607508533, 0.9525559764467614, 0.9423170685969321, 0.9334658515724726, 0.9283276450690784, 0.9357536661290927, 0.9476428009030056, 0.9480928627686307, 0.9476052957460465, 0.9504556876570528, 0.945054945072829, 0.9407418520046507, 0.9684581629974122, 0.9690957506657165, 0.9700333795941646, 0.9705209466301616, 0.971121029141507, 0.972508719948993, 0.971608596181975, 0.9715710910250159, 0.9709335033567116, 0.9713460601011453, 0.004500618835089825, 0.004500618835089825, 0.004500618835089825, 0.004500618835089825, 0.004500618835089825, 0.004500618835089825, 0.004500618835089825, 0.004500618835089825, 0.004500618835089825, 0.004500618835089825, 0.004500618835089825, 0.004500618835089825, 0.004500618835089825, 0.004500618835089825, 0.004538123992048906, 0.004538123992048906, 0.004538123992048906, 0.004538123992048906, 0.004538123992048906, 0.0044256085211716615, 0.004613134305967071, 0.004500618835089825, 0.005475752916025953, 0.004650639462926152, 0.09556313993174062, 0.16652289690167674, 0.21797997224786045, 0.2648989236036719, 0.2956531523117956, 0.32678243258783357, 0.3821025391058326, 0.40655590143980075, 0.4312342947172, 0.46551400819400807, 0.5092075160423966, 0.5486254360008028, 0.5427746315207748, 0.5258598057411707, 0.5759666954250913, 0.6336496268281592, 0.6380002250398836, 0.6677043093514765, 0.689644826170304, 0.7050969508396812, 0.7035217342429287, 0.7497280876299305, 0.726587405786177, 0.7094100438843869, 0.7223868281978179, 0.765480253539332, 0.7793946667711514, 0.7930090387607109, 0.802610358942236, 0.810786483141432, 0.8137493905456704, 0.8208378652243498, 0.8494918051410882, 0.8542924652318508, 0.8294265461545666, 0.8411281551213292, 0.8407531035517384, 0.8665191463826276, 0.8686569403471791, 0.879083373968391, 0.857105351990369, 0.8808461163409969, 0.8542549600614788, 0.8634812286868259, 0.8820837865206466, 0.8898848591681356, 0.8890222405580768, 0.8902224055986512, 0.892397704688865, 0.8854967558039231, 0.8867344260014566, 0.8933728387653302, 0.896073210084268, 0.9085999325086013, 0.9077748190555015, 0.9025991073772643, 0.8898473540290603, 0.9177886959635764, 0.9063871282301317, 0.9185012939457989, 0.9167760567256812, 0.9195139331658103, 0.9249896860818363, 0.9043993549291841, 0.9314030679263102, 0.9101751490829989, 0.9540186775681656, 0.9547687807073473, 0.9547312755503882, 0.9564565127749769, 0.9533435847429022, 0.9555563890034879, 0.9553313580617335, 0.9558189251022016, 0.9570565952818513, 0.9553688632186925]
train_loss_list_2 = [5.5222094988513675, 5.518049889824298, 5.516716309886613, 5.51630895714509, 5.516136038530055, 5.5159660786614975, 5.5158118919143355, 5.515790117572003, 5.515721736917647, 5.515768788320094, 5.515728559023873, 5.5072989887734645, 5.363508580415551, 5.121712821551589, 4.416017116291676, 3.810484127397985, 3.3265853495686213, 2.9106296330684156, 2.5942895578728358, 2.313523257046786, 2.077663146855296, 1.8961934809335017, 1.7345712503465542, 1.582286217609971, 1.4367207186841338, 1.2943298588161147, 1.1755052189470716, 1.0504702190226303, 0.952453907839121, 0.8685696537500446, 0.7906556438338557, 0.7209585974248001, 0.6445646011752538, 0.5977542163624864, 0.5426985468282679, 0.4968631681991168, 0.45952988886442586, 0.4180684998048729, 0.3950154230985644, 0.37106912703243194, 0.3335628748315389, 0.3218433129310959, 0.3035400748413825, 0.28265967593105984, 0.2709519334111452, 0.2576090049559606, 0.24153332333369465, 0.2231277653035596, 0.2117542482319111, 0.19800086538189407, 0.18910576745844015, 0.178161263960966, 0.1760043345091514, 0.16907392942951702, 0.16287530240097153, 0.15913159937188745, 0.1427989953045729, 0.14557631156437192, 0.1379887322870334, 0.1367778890694303, 0.1257565399193569, 0.12307461617889966, 0.1171339733892484, 0.11150596005991459, 0.11928562677941257, 0.10250137856913755, 0.11158783021039353, 0.1024651593123258, 0.09845713411448839, 0.09601578565376298, 0.09459406718300163, 0.09397227359229092, 0.08830936937437911, 0.08690545013392624, 0.08596264297514523, 0.08873174638710106, 0.07678490710776736, 0.07899878775674012, 0.07942315280704712, 0.0751794026408616, 0.08032130533680082, 0.07251627886401353, 0.0705146745409978, 0.07055889623009519, 0.07296923365330892, 0.06627969195389741, 0.06775147333056084, 0.06625350112782115, 0.06388950986780764, 0.062064340922520965, 0.012807474406295857, 0.006668667496361655, 0.00605362049064996, 0.0048734857671789015, 0.004319966949528262, 0.003938480831221388, 0.0037892161349176758, 0.003494054390585783, 0.0033422691884608755, 0.0038471261117393077, 5.521405481340617, 5.518031852628905, 5.51676317336097, 5.51622404784001, 5.515803470936245, 5.515924683427794, 5.515711754585859, 5.515785177973473, 5.515749567734948, 5.515762546607307, 5.515686498043854, 5.5156293337893105, 5.515611491573432, 5.515752770307372, 5.273972225846831, 4.710487383623307, 3.993564270479039, 3.718470432906526, 3.5405795746526545, 3.071412758560252, 2.6364494075849954, 2.346249077586175, 2.089634049173096, 1.85159984081871, 1.637113050679992, 1.4591369199995776, 1.297737466031595, 1.1674376161385174, 1.0361465257531646, 0.9223400451117296, 0.8542544031159284, 0.7652097297836112, 0.6941009601418388, 0.6371925821137693, 0.5809008636281969, 0.5313462415973292, 0.495792344764143, 0.4583351302048805, 0.4164271505786359, 0.3903496421874408, 0.36551776146422343, 0.3397769117706768, 0.31571334717141997, 0.2945085147305402, 0.28124909217119115, 0.2626058472191367, 0.24758959337828246, 0.23448706838666636, 0.22427549471118527, 0.21063974610743205, 0.20410807544180107, 0.18983344480434777, 0.17926063454723076, 0.1768975179581766, 0.1648603531269732, 0.15311810375026408, 0.15390903444733073, 0.14500249956107525, 0.13785725829171133, 0.13360472723719274, 0.13673510421862978, 0.12453388140419167, 0.12135352463656711, 0.1197061620001425, 0.11527490963589584, 0.1105065073109645, 0.10340741005300759, 0.10473768223924104, 0.10278370205974846, 0.09139469198435518, 0.09391581836392615, 0.09164977671562868, 0.08899340330412808, 0.08995608411693527, 0.08581732285879637, 0.08990709987527655, 0.07946863849777507, 0.07787356444985444, 0.07827535151376391, 0.0803662341114863, 0.07107398030129188, 0.07792787777877283, 0.06506450375698244, 0.07206863374471394, 0.06644668669701984, 0.06674929056834573, 0.06434031908359347, 0.06545495275844039, 0.061355498963490775, 0.06071769545982043, 0.012753642898808698, 0.00831302366598338, 0.00614373636440247, 0.005565451197980405, 0.005306587079553536, 0.004860847170534112, 0.0043961407380706, 0.004311389223378154, 0.003964801874860672, 0.0039767909356913985, 5.5213796385800835, 5.518163949214289, 5.516807033595904, 5.516018963039459, 5.515710071204221, 5.515794194950108, 5.515888944746066, 5.515684602989224, 5.515552450291374, 5.515587707046657, 5.515725707803934, 5.515598772339071, 5.5156869680978495, 5.5154870852470905, 5.515516341233647, 5.5155029495081305, 5.515624226412898, 5.515441749118642, 5.515494219639384, 5.514906078365787, 5.165413046581423, 4.8369889729484346, 4.544709235894909, 4.253057801621733, 3.980297524002436, 3.624405842321912, 3.3548221985773714, 3.1350592719267487, 2.9415724704605632, 2.7385419063149015, 2.5594879587839454, 2.3898672058764223, 2.2436942131152606, 2.116016509829433, 1.9909716876922448, 1.8793587534673637, 1.7894455287693847, 1.6817120438711362, 1.5839575877779886, 1.4913720874201721, 1.4184240914083992, 1.3368194691455162, 1.2641142175276279, 1.1971554021475244, 1.1257562937455297, 1.0726665629977352, 1.0262967438665471, 0.9682260760327746, 0.9182937571307731, 0.8689757316096001, 0.833987194900506, 0.7918399562149789, 0.7558632365873131, 0.7094295050088328, 0.6848624224272883, 0.6467981622818955, 0.622758417588204, 0.5981446454562283, 0.5717173298103525, 0.5401568739052791, 0.520049034745819, 0.49725546811732335, 0.48547916048438766, 0.46438351757507657, 0.4453024799636975, 0.4282980016380682, 0.4099281906719692, 0.3941443755569079, 0.38498877518151703, 0.36366901102541704, 0.35377107660777274, 0.3460389630064818, 0.3281830308569581, 0.3174282310908174, 0.3072425884702915, 0.30088818851575927, 0.2823224538424372, 0.2798653852124586, 0.2613024433729164, 0.2591291541595062, 0.2408691056665161, 0.24220429379285516, 0.23131097648335594, 0.22239773726670453, 0.22131131161752501, 0.20380023705375216, 0.19944465289494268, 0.19074742198542208, 0.176727612759502, 0.18287049662292165, 0.07268251659528666, 0.05714980927532732, 0.05052271177186507, 0.04855109706893817, 0.043392733534032286, 0.041729798441731504, 0.040921514226700026, 0.04109372315504123, 0.038320726304823007, 0.036561138744769496]
val_loss_list_2 = [5.518575298282286, 5.515436821615545, 5.515305908560659, 5.514715653136823, 5.514726732147655, 5.514752923818592, 5.51466207740697, 5.514647288319408, 5.514596497838622, 5.514630723454717, 5.514801242554245, 5.481781807896507, 5.203172643459268, 4.897049966176971, 4.041560283217083, 3.3915278347891546, 2.9710958713629068, 2.5973412683325483, 2.3787074477755827, 1.9468570954755926, 1.7248408088125033, 1.5568827612251708, 1.5093790352561354, 1.387046439861476, 1.2280599870240658, 1.0503029684435108, 0.9974818123042822, 0.8578737374677781, 0.7529208838137129, 0.7102732464838237, 0.6944723829123495, 0.6461517293754648, 0.6464568359808558, 0.5302758600421836, 0.46572263029874167, 0.4554337695997126, 0.3970296767803679, 0.37896208218022737, 0.3580823560583347, 0.42845472138485, 0.4218503227269833, 0.37031391140000747, 0.31764189600698617, 0.4300504887769761, 0.4140300108841836, 0.32871416463067005, 0.35400679621300446, 0.3322386291333956, 0.35453097500854025, 0.3062981006159176, 0.24604997196172868, 0.2781812015278037, 0.30146383183742104, 0.29103754414187855, 0.2534566410386422, 0.2902193248117694, 0.23730385270951845, 0.3494397865744769, 0.29098587615581506, 0.25650370791311344, 0.5162273446236361, 0.2516895352660499, 0.2972640076317668, 0.30402391015330915, 0.22270806242698885, 0.2361387711810754, 0.2865579791706009, 0.26221249116626505, 0.3187711649518348, 0.22746949043200781, 0.20808261254293356, 0.24742518665685165, 0.23209065140007348, 0.24813838228938284, 0.2070945345635655, 0.19038842692913946, 0.21054209196726367, 0.2963365926873061, 0.2346009115971718, 0.19876917293756682, 0.26360955123718666, 0.34603207155867083, 0.2859281835950358, 0.2788584828978429, 0.2302007701300534, 0.18399716368276658, 0.35452816032041723, 0.2271211347076221, 0.18932033903095774, 0.25113456113740334, 0.12599380668480314, 0.11527149900842756, 0.11759035775460817, 0.11820817200326418, 0.11924421087121473, 0.1250660296169973, 0.12482737923495255, 0.1283723072147665, 0.12084106884730707, 0.12103477749780085, 5.518119828339676, 5.515672627739362, 5.5154274589538, 5.513402372031954, 5.5150881597447885, 5.514767615796835, 5.514666712955179, 5.5146405811772645, 5.514721433108519, 5.514652368531726, 5.514615147513415, 5.514617273080815, 5.51461669909857, 5.514597436418967, 5.478672432961174, 4.255654700478498, 3.7901966953002177, 3.515620758048557, 3.145145577446928, 2.667390385285879, 2.3103484912130208, 2.000464883246953, 1.8588678774832605, 1.632737269591745, 1.3602022382380818, 1.2950551886692303, 1.0233092770789116, 0.919466078603312, 0.9175573158473401, 0.8311483134177362, 0.7021509168725958, 0.6492451767461296, 0.6544062997700818, 0.6787760816211305, 0.5167023074652407, 0.5040006559420807, 0.5002858268321779, 0.5463669465817949, 0.517725536861097, 0.44462646820215307, 0.40309082981021166, 0.47273044797568775, 0.3479272965451485, 0.3500975231248378, 0.3784080693278967, 0.3640390778144166, 0.36137251881573423, 0.33237047143101944, 0.31685599546953286, 0.29453249599100906, 0.3071570436980084, 0.34487195729585024, 0.2964223573402163, 0.2830521137981504, 0.2835613540901875, 0.291458841247275, 0.29716417272241447, 0.3135507503964603, 0.2669125464774381, 0.28351882254108135, 0.27477060255147073, 0.2810587590478652, 0.26786255129054704, 0.2446111417950967, 0.25081556897260227, 0.2867589896855057, 0.32493530412804467, 0.26909719617637823, 0.2599262686765677, 0.24587086958154922, 0.22463869748661042, 0.28475672778756356, 0.3939115103062857, 0.2775595727780703, 0.26808704009980083, 0.20638148802885967, 0.2409005969619871, 0.24412421371055107, 0.22146942681796578, 0.20555259620190844, 0.24389449786746203, 0.297890574453683, 0.31650342048831737, 0.2963032178499445, 0.23330065506240327, 0.22149964448308582, 0.22641873762126236, 0.22595811853661707, 0.2602517085007861, 0.26962813874922315, 0.1397777825302646, 0.1396178626949181, 0.13946222165225702, 0.14473455796100965, 0.14336450497928874, 0.13463388241788649, 0.13835144547468256, 0.14196731743907082, 0.14816383173347206, 0.14385118844614334, 5.51870824163729, 5.5161954124489885, 5.515174155429688, 5.514809903203245, 5.514665068946274, 5.514632969165838, 5.514729332549223, 5.514622922196363, 5.514618948618953, 5.514627508581863, 5.514626620809542, 5.514624224212358, 5.514609175612214, 5.514609409318398, 5.514613775356951, 5.514608767699423, 5.514730046418961, 5.514653227743533, 5.514754434932589, 5.516010628974129, 5.560156229050855, 5.718864178615505, 5.5012675151460835, 5.60219705708855, 3.7233258551472517, 3.285969467257513, 3.002722957390612, 2.7774619091676183, 2.6370397659207043, 2.46507759768996, 2.250832031191019, 2.1071710861601503, 2.023841905561681, 1.8886279780178066, 1.7415413834196243, 1.5645997273038057, 1.5889889066675278, 1.645216095692549, 1.4727572270462297, 1.2617042450734413, 1.2513314372076882, 1.1521681432216455, 1.0746085091872624, 1.0186778470374762, 1.0171438704435471, 0.8578536479126078, 0.9299669776040446, 1.0089809182426763, 0.9723536120894272, 0.8094900025254819, 0.7576994100260108, 0.7134191603205082, 0.6883369669174569, 0.6625840860062241, 0.6388737468535637, 0.6226324369055839, 0.5249091614635324, 0.5079141988195134, 0.58924903341787, 0.5612873486808171, 0.5610507753977116, 0.4689221511359632, 0.4505739172149553, 0.41899308568873417, 0.5210018851964234, 0.42766646273263426, 0.5068405732181064, 0.5118311662959734, 0.4224422029418491, 0.3908002982057534, 0.41481715670814356, 0.3872262056638495, 0.39639689567293585, 0.42487070557426243, 0.42366554929633093, 0.3789129324258212, 0.38413380115874435, 0.3327255659927303, 0.3403301858879176, 0.36651836321945747, 0.4343862784608326, 0.3191592380691173, 0.3589509876383403, 0.31631061709821795, 0.3144858673528439, 0.3119918019033845, 0.29353595203672356, 0.3693995179665539, 0.2625305696897709, 0.339946991416706, 0.18610142487934078, 0.18207450300177475, 0.18645789470477384, 0.18501733514552493, 0.20055383476194485, 0.19438988329234286, 0.19419207241565992, 0.19631795192929552, 0.18928564138981482, 0.19494617446322313]
train_score_list_2 = [0.003889862247440246, 0.004307781331875975, 0.003938083680259752, 0.003857714625560574, 0.00421133846623696, 0.003938083680259752, 0.004066674167778439, 0.00432385514281581, 0.004130969411537781, 0.003954157491199589, 0.004130969411537781, 0.004468519441274332, 0.009579991320142093, 0.016250622860413438, 0.0466140517255236, 0.10086316364794821, 0.16351887869118836, 0.2324594538123833, 0.2939578544681948, 0.3546364907660747, 0.41058942664907994, 0.4577017665123013, 0.4995579702001126, 0.5406426309632908, 0.5804253130393842, 0.6182469901791411, 0.6540915885766513, 0.6887145773410575, 0.7132110652124091, 0.7409062414627041, 0.7644383006786236, 0.7831160689887966, 0.8056997733592658, 0.8182212720813978, 0.8356292093292399, 0.8478131580216354, 0.858904087570122, 0.8719560220542267, 0.8790124250558565, 0.8855544661083696, 0.8982688505617797, 0.9010978412871907, 0.9053252535643675, 0.9115136707762044, 0.9153874592127047, 0.9194059119486218, 0.925047819587546, 0.930336103386752, 0.9336151608184785, 0.935913715782875, 0.9413466638805394, 0.9441435069840709, 0.9444489093919277, 0.9456705190243133, 0.9493514217285777, 0.9501711860865093, 0.9548486650709596, 0.9544468197974636, 0.9569061128703005, 0.9566167842733834, 0.9607316798739813, 0.9614067799334545, 0.962628389564882, 0.9650394612058573, 0.9626926848086412, 0.967514828090592, 0.9644929516339029, 0.968398887693241, 0.9693311687277515, 0.9696687187565299, 0.9701991545175446, 0.9707617379004388, 0.9720637165865655, 0.9730120714320158, 0.9735103595711507, 0.9727227428350987, 0.9756963978589683, 0.9753106263964123, 0.9757446192927459, 0.9766929741372382, 0.9746837477697587, 0.9779788790124251, 0.9779628052014853, 0.977689550415508, 0.9774645170623503, 0.979248710076672, 0.9795380386735891, 0.979843441081446, 0.9804060244643402, 0.9807114268721971, 0.9963994663494768, 0.9985051355825952, 0.9983443974731969, 0.9987140951248131, 0.9988748332342114, 0.9989873499107903, 0.9989391284779708, 0.9990516451545497, 0.9991802356420684, 0.9987783903685725, 0.003568386028643531, 0.00387378843650041, 0.004066674167778439, 0.004130969411537781, 0.004259559899056468, 0.004372076575635317, 0.004356002764695482, 0.004179190844357288, 0.00443637181939466, 0.004066674167778439, 0.004356002764695482, 0.004018452734958931, 0.004259559899056468, 0.004339928953755646, 0.009242441290405542, 0.022905180589265908, 0.0651471557391542, 0.08858277208943469, 0.10920547152524392, 0.19312683844260528, 0.2777233054187212, 0.34037902046244034, 0.40681208107821853, 0.4674585697527816, 0.529069487085172, 0.5777731342328742, 0.6220725571835405, 0.6588976580467042, 0.6964139327812388, 0.7289312523106103, 0.7494575088826967, 0.7746773182453828, 0.795219648627451, 0.8106183595087716, 0.8281227396203366, 0.8407567550200056, 0.8516226512153345, 0.8622795878684456, 0.8729686721424783, 0.8817610467275264, 0.8881905711044188, 0.8958738527327023, 0.9039429058235418, 0.9094401491668817, 0.9127352804076319, 0.9181843023162362, 0.9230707408419462, 0.927410669797618, 0.9303521771976918, 0.9346921061514475, 0.936010158649472, 0.940125054249112, 0.9425361258900873, 0.9444167617700481, 0.9480815906652886, 0.9519553791017891, 0.9522286338868082, 0.9546718531496633, 0.9556362818060534, 0.9573561795775739, 0.9572758105219167, 0.9609888608499768, 0.9615996656656906, 0.9630463086502757, 0.9639303682510086, 0.9652805683699548, 0.9672897947374343, 0.9667272113545401, 0.9666468422998409, 0.9712600260405317, 0.9705206307363413, 0.9710832141192355, 0.9718547570443477, 0.971340395094273, 0.9732531785961134, 0.9718869046671854, 0.9748766335010368, 0.9763714979184415, 0.9757285454808481, 0.9751659620979538, 0.9772877051429701, 0.9759535788340058, 0.9793290791313712, 0.9770948194107341, 0.9788950862359956, 0.9791201195901115, 0.9797148505939273, 0.9794255219970103, 0.9804863935190394, 0.9813543793097905, 0.9964476877822963, 0.997749666468423, 0.9984247665278961, 0.9986176522591741, 0.998537283204475, 0.9986337260701139, 0.9987783903685725, 0.9988426856123318, 0.9989069808560912, 0.9989552022889107, 0.004356002764695482, 0.004452445630334496, 0.004484593252214167, 0.004066674167778439, 0.0038416408146207384, 0.003922009869319917, 0.004500667063154004, 0.004404224197514989, 0.004548888496213029, 0.004034526545898767, 0.00443637181939466, 0.0042434860881166315, 0.004050600356838603, 0.0042434860881166315, 0.00432385514281581, 0.004356002764695482, 0.004564962306913346, 0.003905936058380081, 0.0038255670036809026, 0.004356002764695482, 0.011219520036005336, 0.01822770160577371, 0.03234050761094948, 0.04974844485879157, 0.06873161557873757, 0.10496198543760632, 0.14324980309581598, 0.18031601112355622, 0.2191021169211403, 0.2577917798530854, 0.295597383183579, 0.3324707054805202, 0.37225338755565557, 0.40007715429251123, 0.4317747094677834, 0.4597592143123608, 0.48147493289231835, 0.5139761786141033, 0.5395656856288846, 0.5646408306950285, 0.5843312490960877, 0.607525758282031, 0.6278752029328212, 0.6488354523976484, 0.6672078183021202, 0.6829119315898606, 0.6955459469895295, 0.7142558629230193, 0.725941523477717, 0.7399900342391335, 0.7511131114085416, 0.7620915242804495, 0.7732146014508158, 0.786893414560616, 0.7943677366476396, 0.8069856782363688, 0.8125472168205938, 0.8202626460707569, 0.8255670036818608, 0.8359024641171332, 0.8404031311793292, 0.8474916818037967, 0.8515101345397137, 0.8575699612640317, 0.8633726070113963, 0.8681465288605276, 0.8737241412566505, 0.8779033321029239, 0.8810859466680534, 0.8870814781495702, 0.8913249642367287, 0.8944915049918764, 0.8990886149197113, 0.9008567341240513, 0.9042161606104769, 0.9050359249674506, 0.911063604069889, 0.9113047112339865, 0.9175252760681819, 0.9177342356099207, 0.9243887933399708, 0.9243566457190492, 0.9276678507707392, 0.9291466413772042, 0.9298378152485751, 0.9367495539517464, 0.9363155610573289, 0.9403983090350891, 0.9437095140896533, 0.9411859257720991, 0.9781074694999438, 0.9826402841849774, 0.9843923295774195, 0.9847459534180959, 0.9867069583527559, 0.986401555944899, 0.9873177631684696, 0.9864176297558388, 0.9880732322826419, 0.9881696751482809]
tb2 = max(train_score_list_2)
vb2 = max(val_score_list_2)
tba2 = (max(train_score_list_2[0:100])+max(train_score_list_2[100:200])+max(train_score_list_2[200:300]))/3.0
vba2 = (max(val_score_list_2[0:100])+max(val_score_list_2[100:200])+max(val_score_list_2[200:300]))/3.0
print(str(tb2)+" "+str(vb2) + " "+str(tba2) +" "+ str(vba2))

train_score_list_2=train_score_list_2[0:100]
val_loss_list_2 = val_loss_list_2[0:100]
train_loss_list_2=train_loss_list_2[0:100]
val_score_list_2=val_score_list_2[0:100]



fig2 = go.Figure()
fig2.add_trace(go.Scatter(y=train_score_list_2, \
                mode='lines', name="train score "))
fig2.add_trace(go.Scatter(y=train_loss_list_2, \
                mode='lines', name="train loss"))
fig2.add_trace(go.Scatter(y=val_score_list_2, \
                mode='lines', name="validation score"))
fig2.add_trace(go.Scatter(y=val_loss_list_2, \
                mode='lines', name="validation loss"))
fig2.update_layout(title='training process of logfbank+SAEP(add noise)', xaxis_title='epoch n', yaxis_title='score or loss')
fig2.write_image("output/logfbank_SAEP_add_noise.png")
# fig2.show()
print(len(train_score_list_2))
print(2)


# wav2vec 2.0 + SAEP
# no noise 
# 20221230_155148_sid
# over-fitting
val_score_list_3 = [0.8703, 0.9461, 0.9700, 0.9759, 0.9787]  
val_loss_list_3 = [0.6096, 0.2174, 0.1138, 0.0905, 0.0905]
train_score_list_3 = [0.3452, 0.8246, 0.9229, 0.9509, 0.9629]
train_loss_list_3 = [0.6096, 0.6325, 0.2753, 0.1721, 0.1282]

tb3 = max(train_score_list_3)
vb3 = max(val_score_list_3)

print(str(tb3)+" "+str(vb3))

fig3 = go.Figure()
fig3.add_trace(go.Scatter(y=train_score_list_3, \
                mode='lines', name="train score"))
fig3.add_trace(go.Scatter(y=train_loss_list_3, \
                mode='lines', name="train loss"))
fig3.add_trace(go.Scatter(y=val_score_list_3, \
                mode='lines', name="validation score"))
fig3.add_trace(go.Scatter(y=val_loss_list_3, \
                mode='lines', name="validation loss"))
fig3.update_layout(title='training process of wav2vec2.0+SAEP(no noise)', xaxis_title='epoch n', yaxis_title='score or loss')
fig3.write_image("output/wav2vec_SAEP_no_noise.png")
# fig3.show()
print(len(train_score_list_3))
print(3)

# wav2vec 2.0 + SAEP
# add noise (训练集和验证集全部样本加了噪声)
# 20221230_160750_sid
train_score_list_4 = [0.17277739379277327, 0.6205133975218974, 0.7910726054059314, 0.8616687830527319, 0.9008245865012136, 0.9199042000887148, 0.9349653609374247, 0.9463938405156479, 0.9521964862649286, 0.9581759439345474, 0.964573320688602, 0.9662289232154051, 0.9698937521096876, 0.971822609422468, 0.973285326217993, 0.9754552906948708, 0.9772716313310723, 0.9780271004452445, 0.9803417292205809, 0.98042209827528, 0.17780849661837894, 0.6198543712748013, 0.7956214939009468, 0.8646585118875413, 0.8985099577258773, 0.9219134264552361, 0.9362512658126115, 0.9475190072814363, 0.9531609149222767, 0.9585295677752238, 0.9637053348978509, 0.9664861041904426, 0.9699901949753267, 0.9718065356115282, 0.9742819024962628, 0.9751820359098518, 0.9776252551717487, 0.9788147171812965, 0.9802292125440021, 0.981113272145693, 0.1809107421280906, 0.6235834954128431, 0.7913137125681128, 0.8620224068924501, 0.898638548213396, 0.9213669168823236, 0.9367817015736261, 0.9447221641779049, 0.9519232314789513, 0.9595100702435119, 0.9612299680140743, 0.9658110041319274, 0.9689936186970569, 0.97064922122386, 0.9742015334415637, 0.9749570025557359, 0.9771751884654333, 0.9784610933406201, 0.9799238101361452, 0.9800684744346037]
val_score_list_4 = [0.6444511120346103, 0.8523797022157602, 0.9025991073951483, 0.932640738101489, 0.9297153358586806, 0.9425420995386866, 0.9462551100776356, 0.9489554813786896, 0.940441810748978, 0.9485054194951806, 0.9492180174774032, 0.951430821737989, 0.9546562652364701, 0.9573566365375239, 0.9543562239807973, 0.9561939766896762, 0.9577691932819576, 0.9575441623223193, 0.9497805948496733, 0.9542437085099201, 0.6066834189745793, 0.8420282788883472, 0.9035367363191252, 0.9127630049131755, 0.9279900986385629, 0.9384540374301467, 0.9402542849641826, 0.9453924914675768, 0.9449799347410269, 0.948730450454819, 0.9477178112035108, 0.9519558939354161, 0.9505682031279301, 0.9530060383481542, 0.9507932340696846, 0.9530435434917005, 0.9553313580617335, 0.9518808836214979, 0.9579192138919101, 0.9570941004388104, 0.6437010089066061, 0.852979784738283, 0.8953231069450863, 0.9259648201627724, 0.9294903049348099, 0.9351910887747065, 0.9458800585080449, 0.9449424296019516, 0.9386790683719012, 0.9459925739968059, 0.9472302441585718, 0.9483178937148561, 0.9522559351910888, 0.9548437910391493, 0.9533810899177451, 0.9567940592010216, 0.9586693170489756, 0.9540561827251247, 0.9586318118741327, 0.9575066571653602]
train_loss_list_4 = [3.7551314979281467, 1.350995678173383, 0.7220358302584685, 0.47218337433896107, 0.33800271246670593, 0.2693118041307977, 0.21701754872327988, 0.17937081679280403, 0.15601465354043767, 0.13729171696987758, 0.11774336840692316, 0.11161809996637032, 0.09821563105328257, 0.0926550088474156, 0.08820334193118215, 0.07944783083211286, 0.07257642104132524, 0.07148982766003385, 0.0657253019660182, 0.06308232828466316, 3.6876179306193593, 1.3396840554264913, 0.7091928430690454, 0.4658637875768151, 0.34136437218098376, 0.2658430059087249, 0.21222057502789893, 0.1765532733842402, 0.15576701265164308, 0.1368287955164299, 0.12183195944248719, 0.11137433545335663, 0.09994326191002903, 0.09069769690339448, 0.08356289905709338, 0.07970643597718845, 0.07307958871489285, 0.0700146545538856, 0.06597005527602402, 0.062436691725922935, 3.6866945755157317, 1.3387921244725653, 0.7190286140773542, 0.47444165259805193, 0.34000844053551993, 0.267587662420133, 0.21553726048975635, 0.18329009713416636, 0.15904969135583605, 0.13527798461680868, 0.1275001326660156, 0.11056602743978808, 0.10390403459107485, 0.09491310390492534, 0.08491576084247036, 0.08111925423031523, 0.07482058783056039, 0.07323692274641595, 0.06594047983345912, 0.06572079011068978]
val_loss_list_4 = [1.4828410574837518, 0.5715595101423142, 0.3658768448639009, 0.25033981388868104, 0.25495644558339126, 0.2055851899099864, 0.19653924799343697, 0.19748765808756388, 0.21902333160581006, 0.19912886648112177, 0.19453269608037763, 0.19917579491309115, 0.18611615709122156, 0.17326565462535326, 0.1910282000160034, 0.18230549203067692, 0.1780853209600919, 0.1840760293075244, 0.22452435497162324, 0.19669004010394753, 1.592820211057388, 0.5948342883957526, 0.36683408316105076, 0.3137802380708136, 0.2621733911438999, 0.22323480634924078, 0.22216604970448936, 0.21025530781361615, 0.20317022128454212, 0.19992909746467608, 0.20445252663453073, 0.19003466871996597, 0.20521251220054967, 0.1983061410872738, 0.2107431382743087, 0.21697202010053812, 0.1953105996805595, 0.2207770344388707, 0.19016551931696368, 0.18958961092830456, 1.4444555544743225, 0.5697088528635336, 0.3878475382135514, 0.2701286602722987, 0.26217346312815254, 0.24314064029604895, 0.20383476820780383, 0.21286594364443512, 0.23473210175073983, 0.2280802371862908, 0.2002292825732377, 0.19842855069571563, 0.1939404385127582, 0.18779924684460716, 0.19721954768449593, 0.19003384091077108, 0.17368531768433676, 0.19718527895560267, 0.17765228542850847, 0.1866919935134595]
tb4 = max(train_score_list_4)
vb4 = max(val_score_list_4)
tba4 = (max(train_score_list_4[0:20])+max(train_score_list_4[20:40])+max(train_score_list_4[40:60]))/3.0
vba4 = (max(val_score_list_4[0:20])+max(val_score_list_4[20:40])+max(val_score_list_4[40:60]))/3.0
print(str(tb4)+" "+str(vb4) + " "+str(tba4) +" "+ str(vba4))

train_score_list_4=train_score_list_4[0:20]
val_loss_list_4 = val_loss_list_4[0:20]
train_loss_list_4=train_loss_list_4[0:20]
val_score_list_4 =val_score_list_4[0:20]

fig4 = go.Figure()
fig4.add_trace(go.Scatter(y=train_score_list_4, \
                mode='lines', name="train score"))
fig4.add_trace(go.Scatter(y=train_loss_list_4, \
                mode='lines', name="train loss"))
fig4.add_trace(go.Scatter(y=val_score_list_4, \
                mode='lines', name="validation score"))
fig4.add_trace(go.Scatter(y=val_loss_list_4, \
                mode='lines', name="validation loss"))
fig4.update_layout(title='training process of wav2vec2.0+SAEP(add noise)', xaxis_title='epoch n', yaxis_title='score or loss')
fig4.write_image("output/wav2vec_SAEP_add_noise.png")
# fig4.show()
print(len(train_score_list_4))
print(4)

# logfbank + SAEP
# add noise (训练集和验证集有一半加了噪声)
# 20221229_201143_sid
train_score_list_5 = [0.005899088614919711, 0.026971854757044347, 0.09782521338031926, 0.27722501727958626, 0.5357561924361436, 0.7044829858715992, 0.7879221384598074, 0.8400495073386528, 0.8681465288624437, 0.889733656954643, 0.9072541108771479, 0.9179914165849581, 0.925947953002093, 0.9326668059730281, 0.9381479755035121, 0.9417645829659332, 0.9471493096298201, 0.9514249433398164, 0.9542539340652275, 0.9575490653078939, 0.020429813704531206, 0.1682767267291402, 0.4810409399974218, 0.6738463022207514, 0.7722501727944256, 0.826418915661672, 0.8631957950910581, 0.8842203398003633, 0.9001012650098791, 0.914085480526578, 0.9225403050818897, 0.9314451963416006, 0.9398035780322314, 0.9438702521980936, 0.9489013550222622, 0.9520036005336505, 0.9554112484538537, 0.9565364152186842, 0.9586260106408628, 0.9623069133460852, 0.018340218282352563, 0.20971501133299478, 0.546975712472628, 0.7148827415511101, 0.7915387459222285, 0.8362721617668333, 0.8656872357867327, 0.8866314114413386, 0.9019336794560623, 0.9132335685477249, 0.9233922170626591, 0.9283750984530501, 0.936010158648514, 0.940896597174224, 0.9454937071030171, 0.947647597768955, 0.9519393052898912, 0.9530162506228602, 0.9582884606111263, 0.9591885940247151]
train_loss_list_5 = [5.504893060839059, 5.114449615247658, 4.3861927455295495, 3.140331468444497, 1.8231620835270734, 1.1027930099300043, 0.7605016380364048, 0.5724618407600903, 0.4668252018427616, 0.3873331239835766, 0.32555169024091596, 0.2861498085714537, 0.257897613624854, 0.22969721429269024, 0.20972335438525613, 0.19800195408985888, 0.17683009106299447, 0.16324092342243857, 0.1538730873077887, 0.1414464651476215, 5.213518935958469, 3.7515107899568445, 2.0544518684096533, 1.213789880815122, 0.8212907778870518, 0.6204521161957722, 0.48777671613213175, 0.40354156096947186, 0.34402456149276134, 0.294027704658526, 0.261425641419226, 0.23151454680442074, 0.20455713643458498, 0.18850695204485607, 0.17146879293868483, 0.16119612798787322, 0.14688107807678982, 0.15017566922110465, 0.14453367258934063, 0.1207732725448338, 5.238349205599169, 3.4377239342777304, 1.6993115718468226, 1.0408434061275724, 0.7426849165573713, 0.5757703829970532, 0.46874386432640064, 0.3931247767041175, 0.34006028895859025, 0.3024637007579954, 0.2601449859108196, 0.24419426193007443, 0.2159688050460013, 0.19993448482815934, 0.1834946956546647, 0.1749052589289041, 0.1619401712621998, 0.15544176994717127, 0.1405791496765236, 0.1371773144874641]
val_score_list_5 = [0.010426433634624761, 0.07669804598132243, 0.2118291265048944, 0.5076698046014855, 0.7637175111577842, 0.8238757829201515, 0.891010013876908, 0.9108127367513033, 0.9200765105201966, 0.9234894798213569, 0.9350410681647541, 0.9423920789108502, 0.941791996399505, 0.941867006713423, 0.9460300791358812, 0.9438172748752953, 0.9544312343125994, 0.956494017927465, 0.9593819150311982, 0.9555563890034879, 0.08659940741852004, 0.45741289427966897, 0.7131605595858838, 0.8164872669992124, 0.8655440123061624, 0.8958481791246297, 0.9209766343050984, 0.9328282639041682, 0.935003563007795, 0.9443798522475655, 0.946367625548513, 0.9538311517833702, 0.9620822863143682, 0.9502306567152984, 0.9572816262236058, 0.9602070284664141, 0.9627198739826727, 0.9090499943742265, 0.9606195851929641, 0.9477928215129581, 0.06387128230131643, 0.532985785552219, 0.7574541499635014, 0.8474290215083388, 0.869482053800279, 0.910625210966508, 0.9053744890101203, 0.9294152946030079, 0.9333908412585544, 0.9416419757716686, 0.9377039342976714, 0.9481303679434736, 0.9512432959531936, 0.9483178937103852, 0.9555188838465289, 0.9436297490904999, 0.9572066159275714, 0.9654952555976447, 0.9603945542512096, 0.9465926564902674]
val_loss_list_5 = [5.416562025247384, 4.624961262681374, 3.7194559237463674, 2.0756657760946178, 0.9381877187155633, 0.6652175479347823, 0.4048590724644745, 0.3253860697929156, 0.28291837109166673, 0.2718350943465058, 0.23499168137212278, 0.20147767466695296, 0.20654447724832706, 0.20590899403415566, 0.19382228984703956, 0.19998700914743617, 0.16240784515937357, 0.16055599834648548, 0.14958293223168503, 0.1683473523283659, 4.4984741731715285, 2.393450020482963, 1.1243774482879565, 0.6974240196841882, 0.5037312388187615, 0.37716581169418745, 0.28090311796824446, 0.24126279390757358, 0.23522657206903694, 0.19459504457343274, 0.18230478713458032, 0.16451139959522373, 0.13599945261577914, 0.1683898215693387, 0.15357942783886164, 0.1398312760463926, 0.13221039164514334, 0.42685303767551425, 0.14271648413975427, 0.1988052038050767, 4.496999315948509, 1.9111130385299968, 0.9130422572857467, 0.5585561428022497, 0.46548467815286715, 0.31996617179482867, 0.34841896998472305, 0.2501752697441611, 0.23752086450631293, 0.2138586021208171, 0.21853604058915693, 0.18961026493353894, 0.17110412726999258, 0.18587426721479106, 0.15758600261435246, 0.20504558383358032, 0.15416190310643707, 0.12451743236065807, 0.14154384544716916, 0.19922696369156737]
tb5 = max(train_score_list_5)
vb5 = max(val_score_list_5)
tba5 = (max(train_score_list_5[0:20])+max(train_score_list_5[20:40])+max(train_score_list_5[40:60]))/3.0
vba5 = (max(val_score_list_5[0:20])+max(val_score_list_5[20:40])+max(val_score_list_5[40:60]))/3.0
print(str(tb5)+" "+str(vb5) + " "+str(tba5) +" "+ str(vba5))
train_score_list_5=train_score_list_5[0:20]
val_loss_list_5 = val_loss_list_5[0:20]
train_loss_list_5=train_loss_list_5[0:20]
val_score_list_5 =val_score_list_5[0:20]



fig5 = go.Figure()
fig5.add_trace(go.Scatter(y=train_score_list_5, \
                mode='lines', name="train score"))
fig5.add_trace(go.Scatter(y=train_loss_list_5, \
                mode='lines', name="train loss"))
fig5.add_trace(go.Scatter(y=val_score_list_5, \
                mode='lines', name="validation score"))
fig5.add_trace(go.Scatter(y=val_loss_list_5, \
                mode='lines', name="validation loss"))
fig5.update_layout(title='training process of logfbank+SAEP(50% noise)', xaxis_title='epoch n', yaxis_title='score or loss')
fig5.write_image("output/logfbank_SAEP_half_noise.png")
# fig5.show()
print(len(train_score_list_5))
print(5)

# wav2vec 2.0 + SAEP
# add noise (训练集和验证集有一半加了噪声)
# 20221230_155951_sid
train_score_list_6 = [0.22358671017335446, 0.6763055952955043, 0.8183498625708326, 0.8762798771970425, 0.9071576680124669, 0.9274428174175815, 0.9369424396830245, 0.9484673621268866, 0.9543182293099449, 0.9590117821034189, 0.9621301014257471, 0.967225499494633, 0.9696044235127707, 0.9726262999694597, 0.9733978428945719, 0.9760982431324643, 0.9757446192917879, 0.9772234098982527, 0.9787022005047177, 0.9804703197080996, 0.24293957854659332, 0.7052223811743527, 0.8367865237169081, 0.8912445951810715, 0.917911047530259, 0.9332936846006398, 0.9431147830839214, 0.9523090029424655, 0.957725877228232, 0.9623069133460852, 0.9661164065388262, 0.9691865044283349, 0.9699901949762848, 0.9731245881085947, 0.9745390834713002, 0.9780913956890039, 0.977802067093045, 0.9789111600469356, 0.9803095815987012, 0.98043817208622, 0.19439666950661277, 0.641087875524408, 0.810955909536592, 0.8757655152460097, 0.9085882371851542, 0.9253210743735232, 0.9380836802607109, 0.9474707858486169, 0.954800443637182, 0.9590760773471783, 0.9635606705993924, 0.9679648947978655, 0.9687685853438992, 0.972497709481941, 0.9735425071930304, 0.9750855930432546, 0.9762429074309228, 0.9783485766640413, 0.9783646504749811, 0.9791040457782135]
val_score_list_6 = [0.6936578779649257, 0.869894610513416, 0.9074372726428698, 0.9403668004350598, 0.9506807185988073, 0.9513558114240708, 0.9512808011101527, 0.9617072347447774, 0.9515808423658253, 0.9639950493192814, 0.9618197502156547, 0.9632449461800998, 0.9662078535798673, 0.961519708959982, 0.9637325132205679, 0.9695458125671094, 0.9680081011183741, 0.9707084724149571, 0.9723962044959996, 0.961969770843491, 0.7339384165389796, 0.8927352510970259, 0.9242395829605384, 0.9398417282376327, 0.9512057907962345, 0.9507557289127255, 0.9526684919176387, 0.9598319768968233, 0.9565315230844241, 0.959194389228519, 0.961557214134825, 0.9635074822966971, 0.9646326369875858, 0.9625323481978773, 0.970220905374489, 0.9659828226381127, 0.9725837302629111, 0.9657202865393991, 0.965195214341972, 0.9737088849716836, 0.6510520196571732, 0.8805460750853242, 0.9211266549329347, 0.9360912125417244, 0.9423920789108502, 0.9527059970745978, 0.9474177699433672, 0.9566065334162261, 0.9572816262236058, 0.9627573791575156, 0.9692082661365938, 0.959681956273458, 0.9587068221880508, 0.9638450286914451, 0.968383152683494, 0.9698833589797411, 0.9665078948534237, 0.9705209466301616, 0.9675955443873533, 0.9663203690507445]
val_loss_list_6 = [1.2430477158876547, 0.49876478463394563, 0.3364859907780817, 0.21693411296059517, 0.18065962817607786, 0.17089029809474227, 0.178858865640533, 0.14104407419782863, 0.17899206364664616, 0.13354670709291816, 0.1439212670693345, 0.1399490861504727, 0.13788952398161516, 0.14993177755572415, 0.13581156543978667, 0.12559062508139904, 0.12503280693223848, 0.11406492761935864, 0.1150505736769777, 0.1592664737646027, 1.1131209227157381, 0.4188183219345066, 0.28328012435598904, 0.22616309120192607, 0.18549416702652452, 0.17953632787610227, 0.17354677594922632, 0.1541604624995976, 0.16243498169857584, 0.15618745584465762, 0.1510727473713517, 0.14511077169905823, 0.14618484138689733, 0.14799080485353625, 0.11887711496503672, 0.1326968459742032, 0.11682688244434704, 0.13958031703201995, 0.1421262154208982, 0.11407076857518204, 1.438995498537512, 0.484872413354236, 0.2995655151366365, 0.2307293341420243, 0.22028604312589423, 0.17270675812988084, 0.192605010632818, 0.15877885731722405, 0.1688971068844986, 0.14254408606016813, 0.11962461495679914, 0.15885254891658934, 0.16123326658782533, 0.13962065614281388, 0.13696028375612945, 0.1257580182152273, 0.14081962436325274, 0.11633889365232047, 0.1318785431833681, 0.135155596101935]
train_loss_list_6 = [3.4666985482662005, 1.1514750023029825, 0.6302773896935012, 0.42760271244503734, 0.31887157424603435, 0.24972452986191143, 0.2131025195473988, 0.17626872606871563, 0.15583263357468233, 0.13817259992524683, 0.12557441381769296, 0.1110397831414241, 0.10458349360204965, 0.09404696165542187, 0.09176510185290823, 0.08185802060100746, 0.0821672471149086, 0.07625166630576924, 0.0722427862364029, 0.0641687127985753, 3.410177281940533, 1.0432911573170622, 0.5695656023853954, 0.3790716854188509, 0.2870057833470083, 0.23216677002811528, 0.19224420958987146, 0.16133734935874938, 0.1436281210072374, 0.13213843992250537, 0.11501997660720908, 0.10676309052730107, 0.10030467224228781, 0.09071175075658978, 0.0845652879752972, 0.07777940330912762, 0.07519768839039892, 0.07297762614762694, 0.0670090009215809, 0.06612471193875472, 3.5999160467828166, 1.2710853090295913, 0.6552748176757147, 0.4295576594295349, 0.3137960567960952, 0.25175766965083246, 0.21042469714400436, 0.1800280148398615, 0.153380169020938, 0.1381845266130375, 0.12683173668232842, 0.10978670819761267, 0.10563017765001782, 0.09297188838390312, 0.08892174312493334, 0.0852959869940871, 0.08074774711652533, 0.07333977240545132, 0.07137852926836269, 0.06876721748389819]
tb6 = max(train_score_list_6)
vb6 = max(val_score_list_6)
tba6 = (max(train_score_list_6[0:20])+max(train_score_list_6[20:40])+max(train_score_list_6[40:60]))/3.0
vba6 = (max(val_score_list_6[0:20])+max(val_score_list_6[20:40])+max(val_score_list_6[40:60]))/3.0
print(str(tb6)+" "+str(vb6) + " "+str(tba6) +" "+ str(vba6))

train_score_list_6=train_score_list_6[0:20]
val_loss_list_6 = val_loss_list_6[0:20]
train_loss_list_6=train_loss_list_6[0:20]
val_score_list_6 =val_score_list_6[0:20]

fig6 = go.Figure()
fig6.add_trace(go.Scatter(y=train_score_list_6, \
                mode='lines', name="train score"))
fig6.add_trace(go.Scatter(y=train_loss_list_6, \
                mode='lines', name="train loss"))
fig6.add_trace(go.Scatter(y=val_score_list_6, \
                mode='lines', name="validation score"))
fig6.add_trace(go.Scatter(y=val_loss_list_6, \
                mode='lines', name="validation loss"))
fig6.update_layout(title='training process of wav2vec2.0+SAEP(50% noise)', xaxis_title='epoch n', yaxis_title='score or loss')
fig6.write_image("output/wav2vec_SAEP_half_noise.png")
# fig6.show()
print(len(train_score_list_6))
print(6)

# wav2vec 2.0 + mlp
# no noise
# 20221229_130145_sid
train_score_list_7 = [0.7313, 0.9796, 0.9787, 0.9824, 0.9864]
train_loss_list_7 = [1.1261, 0.0741, 0.0692, 0.0553, 0.0441]
val_score_list_7 = [0.9134, 0.8893, 0.8975, 0.9018, 0.9026]
val_loss_list_7 = [0.2937, 0.3909, 0.3701, 0.3851, 0.3934]
tb7 = max(train_score_list_7)
vb7 = max(val_score_list_7)

print(str(tb7)+" "+str(vb7))

fig7 = go.Figure()
fig7.add_trace(go.Scatter(y=train_score_list_7, \
                mode='lines', name="train score"))
fig7.add_trace(go.Scatter(y=train_loss_list_7, \
                mode='lines', name="train loss"))
fig7.add_trace(go.Scatter(y=val_score_list_7, \
                mode='lines', name="validation score"))
fig7.add_trace(go.Scatter(y=val_loss_list_7, \
                mode='lines', name="validation loss"))
fig7.update_layout(title='training process of wav2vec2.0+MLP(no noise)', xaxis_title='epoch n', yaxis_title='score or loss')
fig7.write_image("output/wav2vec_MLP_no_noise.png")
# fig7.show()
print(len(train_score_list_7))
print(7)

# wav2vec 2.0 + mlp
# 50% noise
# 20221229_131213_sid
train_score_list_8 = [0.5396, 0.8854, 0.9359, 0.9519, 0.9644]
train_loss_list_8 = [1.9572, 0.4164, 0.2266, 0.1643, 0.1211]
val_score_list_8 = [0.7434, 0.7840, 0.7764, 0.7881, 0.7762]
val_loss_list_8 = [0.9298, 0.7756, 0.8418, 0.8174, 0.9239]
tb8 = max(train_score_list_8)
vb8 = max(val_score_list_8)
print(str(tb8)+" "+str(vb8))

fig8 = go.Figure()
fig8.add_trace(go.Scatter(y=train_score_list_8, \
                mode='lines', name="train score"))
fig8.add_trace(go.Scatter(y=train_loss_list_8, \
                mode='lines', name="train loss"))
fig8.add_trace(go.Scatter(y=val_score_list_8, \
                mode='lines', name="validation score"))
fig8.add_trace(go.Scatter(y=val_loss_list_8, \
                mode='lines', name="validation loss"))
fig8.update_layout(title='training process of wav2vec2.0+MLP(50% noise)', xaxis_title='epoch n', yaxis_title='score or loss')
fig8.write_image("output/wav2vec_MLP_half_noise.png")
# fig8.show()
print(len(train_score_list_8))
print(8)

fig9 = go.Figure()
fig9.add_trace(go.Scatter(y=train_score_list_1, \
                mode='lines', name="logfbank+SAEP(no noise)"))
fig9.add_trace(go.Scatter(y=train_score_list_2, \
                mode='lines', name="logfbank+SAEP(add noise)"))
fig9.add_trace(go.Scatter(y=train_score_list_3, \
                mode='lines', name="wav2vec2.0+SAEP(no noise)"))
fig9.add_trace(go.Scatter(y=train_score_list_4, \
                mode='lines', name="wav2vec2.0+SAEP(add noise)"))
fig9.add_trace(go.Scatter(y=train_score_list_5, \
                mode='lines', name="logfbank+SAEP(%50 noise)"))
fig9.add_trace(go.Scatter(y=train_score_list_6, \
                mode='lines', name="wav2vec2.0+SAEP(%50 noise)"))
fig9.add_trace(go.Scatter(y=train_score_list_7, \
                mode='lines', name="wav2vec2.0+MLP(no noise)"))
fig9.add_trace(go.Scatter(y=train_score_list_8, \
                mode='lines', name="wav2vec2.0+MLP(%50 noise)"))
fig9.update_layout(title='train score(accuracy) of different model settings', xaxis_title='epoch n', yaxis_title='score')
fig9.write_image("output/train_score.png")
# fig9.show()


fig = go.Figure()
fig.add_trace(go.Scatter(y=val_score_list_1, \
                mode='lines', name="logfbank+SAEP(no noise)"))
fig.add_trace(go.Scatter(y=val_score_list_2, \
                mode='lines', name="logfbank+SAEP(add noise)"))
fig.add_trace(go.Scatter(y=val_score_list_3, \
                mode='lines', name="wav2vec2.0+SAEP(no noise)"))
fig.add_trace(go.Scatter(y=val_score_list_4, \
                mode='lines', name="wav2vec2.0+SAEP(add noise)"))
fig.add_trace(go.Scatter(y=val_score_list_5, \
                mode='lines', name="logfbank+SAEP(%50 noise)"))
fig.add_trace(go.Scatter(y=val_score_list_6, \
                mode='lines', name="wav2vec2.0+SAEP(%50 noise)"))
fig.add_trace(go.Scatter(y=val_score_list_7, \
                mode='lines', name="wav2vec2.0+MLP(no noise)"))
fig.add_trace(go.Scatter(y=val_score_list_8, \
                mode='lines', name="wav2vec2.0+MLP(%50 noise)"))
fig.update_layout(title='validation score(accuracy) of different model settings', xaxis_title='epoch n', yaxis_title='score')
fig.write_image("output/validation_score.png")
# fig.show()



